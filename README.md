# Страница «Главная»

1 Реализована функция для страницы «Главная».

2 Функция для страницы «Главная» принимает на вход строку с датой и временем в формате
YYYY-MM-DD HH:MM:SS
.

3 Функция для страницы «Главная» расположена в модуле
views.py
.

4 Вспомогательные функции, необходимые для работы функции страницы «Главная», расположены в модуле
utils.py
.

5 Функция для страницы «Главная» отдает корректный JSON-ответ согласно ТЗ
.

6 Вспомогательные функции, необходимые для работы функции страницы «Главная», используют библиотеку
json
.

7 Вспомогательные функции, необходимые для работы функции страницы «Главная», используют API
.

8 Вспомогательные функции, необходимые для работы функции страницы «Главная», используют библиотеку
datetime
.

9 Вспомогательные функции, необходимые для работы функции страницы «Главная», используют библиотеку
logging
.

10 Вспомогательные функции, необходимые для работы функции страницы «Главная», используют библиотеку
pandas
.

# Страница «События»

1 Реализована функция для страницы «События»
.

2 Функция для страницы «События» принимает на вход
DataFrame
.

3 Функция для страницы «События» расположена в модуле
views.py
.

4 Вспомогательные функции, необходимые для работы функции страницы «События», расположены в модуле
utils.py
.

5 Функция для страницы «События» отдает корректный JSON-ответ согласно ТЗ
.

6 Вспомогательные функции, необходимые для работы функции страницы «События», используют библиотеку
json
.

7 Вспомогательные функции, необходимые для работы функции страницы «События», используют API
.

8 Вспомогательные функции, необходимые для работы функции страницы «События», используют библиотеку
datetime
.

9 Вспомогательные функции, необходимые для работы функции страницы «События», используют библиотеку
logging
.

10 Вспомогательные функции, необходимые для работы функции страницы «События», используют библиотеку
pandas
.

## Описание данных

Дата операции — дата, когда произошла транзакция.

Дата платежа — дата, когда был произведен платеж.

Номер карты — последние 4 цифры номера карты.

Статус — статус операции (например, OK , FAILED).

Сумма операции — сумма транзакции в оригинальной валюте.

Валюта операции — валюта, в которой была произведена транзакция.

Сумма платежа — сумма транзакции в валюте счета.

Валюта платежа — валюта счета.

Кешбэк — размер полученного кешбэка.

Категория — категория транзакции.

MCC — код категории транзакции (соответствует международной классификации).

Описание — описание транзакции.

Бонусы (включая кешбэк) — количество полученных бонусов (включая кешбэк).

Округление на «Инвесткопилку» — сумма, которая была округлена и переведена на «Инвесткопилку».

Сумма операции с округлением — сумма транзакции, округленная до ближайшего целого числа.

# Функциональные требования

Изучите функциональные требования к своей задаче и выполните ее. Для этого под спойлерами найдите категорию и задачу,
которую вы выбрали для реализации.

Веб-страницы
Основные функции для генерации JSON-ответов реализуйте в отдельном модуле
views.py
.

Данные для анализа и вывода на веб-страницах — это данные с начала месяца, на который выпадает входящая дата, по
входящую дату.

Если дата —
20.05.2020
, то данные для анализа будут в диапазоне
01.05.2020-20.05.2020
.

Валюты и акции для отображения на веб-страницах задаются в отдельном файле пользовательских настроек
user_settings.json
.

Пример:

{
"user_currencies": ["USD", "EUR"],
"user_stocks": ["AAPL", "AMZN", "GOOGL", "MSFT", "TSLA"]
}
Для получения данных о валютах и ценах на акции используйте библиотеку
requests
.

Сервисы, предоставляющие API для курса валют и цен на акции, подберите самостоятельно.

Как JSON-ответ используется веб-страницей
Страница «Главная»
#json

#requests

#API

#datetime

#logging

#pytest

#pandas

Реализуйте набор функций и главную функцию, принимающую на вход строку с датой и временем в формате
YYYY-MM-DD HH:MM:SS
и возвращающую JSON-ответ со следующими данными:

Приветствие в формате
"???"
, где
???
— «Доброе утро» / «Добрый день» / «Добрый вечер» / «Доброй ночи» в зависимости от текущего времени.
По каждой карте:
последние 4 цифры карты;
общая сумма расходов;
кешбэк (1 рубль на каждые 100 рублей).
Топ-5 транзакций по сумме платежа.
Курс валют.
Стоимость акций из S&P500.
Пример структуры JSON-ответа
Пример использования JSON-ответа на странице
Страница «События»
#json

#requests

#API

#datetime

#logging

#pytest

#pandas

Реализуйте набор функций и главную функцию, принимающую на вход строку с датой и второй необязательный параметр —
диапазон данных. По умолчанию диапазон равен одному месяцу (с начала месяца, на который выпадает дата, по саму дату).

Возможные значения второго необязательного параметра:

W
— неделя, на которую приходится дата;
M
— месяц, на который приходится дата;
Y
— год, на который приходится дата;
ALL
— все данные до указанной даты.
Возвращаемый JSON-ответ содержит следующие данные:

# «Расходы»:
Общая сумма расходов.
Раздел «Основные», в котором траты по категориям отсортированы по убыванию. Данные предоставляются по 7 категориям с
наибольшими тратами, траты по остальным категориям суммируются и попадают в категорию «Остальное».
Раздел «Переводы и наличные», в котором сумма по категориям «Наличные» и «Переводы» отсортирована по убыванию.
«Поступления»:
Общая сумма поступлений.
Раздел «Основные», в котором поступления по категориям отсортированы по убыванию.
Курс валют.
Стоимость акций из S&P 500.
Цифры по тратам и поступлениям округлите до целых.

Пример JSON-строки с ответом

{
"expenses": {
"total_amount": 32101,
"main":
[
{
"category": "Супермаркеты",
"amount": 17319
},
{
"category": "Фастфуд",
"amount": 3324
},
{
"category": "Топливо",
"amount": 2289
},
{
"category": "Развлечения",
"amount": 1850
},
{
"category": "Медицина",
"amount": 1350
},
{
"category": "Остальное",
"amount": 2954
}
],
"transfers_and_cash": [
{
"category": "Наличные",
"amount": 500
},
{
"category": "Переводы",
"amount": 200
}
]
},

"income": {
"total_amount": 54271,
"main": [
{
"category": "Пополнение_BANK007",
"amount": 33000
},
{
"category": "Проценты_на_остаток",
"amount": 1242
},
{
"category": "Кэшбэк",
"amount": 29
}
]
},

"currency_rates": [
{
"currency": "USD",
"rate": 73.21
},
{
"currency": "EUR",
"rate": 87.08
}
],

"stock_prices": [
{
"stock": "AAPL",
"price": 150.12
},
{
"stock": "AMZN",
"price": 3173.18
},
{
"stock": "GOOGL",
"price": 2742.39
},
{
"stock": "MSFT",
"price": 296.71
},
{
"stock": "TSLA",
"price": 1007.08
}
]
}

Пример использования данных на странице



Пример структуры JSON-ответа
{
  "greeting": "Добрый день",
  "cards": [
    {
      "last_digits": "5814",
      "total_spent": 1262.00,
      "cashback": 12.62
    },
    {
      "last_digits": "7512",
      "total_spent": 7.94,
      "cashback": 0.08
    }
  ],
  "top_transactions": [
    {
      "date": "21.12.2021",
      "amount": 1198.23,
      "category": "Переводы",
      "description": "Перевод Кредитная карта. ТП 10.2 RUR"
    },
    {
      "date": "20.12.2021",
      "amount": 829.00,
      "category": "Супермаркеты",
      "description": "Лента"
    },
    {
      "date": "20.12.2021",
      "amount": 421.00,
      "category": "Различные товары",
      "description": "Ozon.ru"
    },
    {
      "date": "16.12.2021",
      "amount": -14216.42,
      "category": "ЖКХ",
      "description": "ЖКУ Квартира"
    },
    {
      "date": "16.12.2021",
      "amount": 453.00,
      "category": "Бонусы",
      "description": "Кешбэк за обычные покупки"
    }
  ],
  "currency_rates": [
    {
      "currency": "USD",
      "rate": 73.21
    },
    {
      "currency": "EUR",
      "rate": 87.08
    }
  ],
  "stock_prices": [
    {
      "stock": "AAPL",
      "price": 150.12
    },
    {
      "stock": "AMZN",
      "price": 3173.18
    },
    {
      "stock": "GOOGL",
      "price": 2742.39
    },
    {
      "stock": "MSFT",
      "price": 296.71
    },
    {
      "stock": "TSLA",
      "price": 1007.08
    }
  ]
}

